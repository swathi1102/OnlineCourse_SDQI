# This workflow will initiate a Veracode Static Analysis Pipeline scan, return a results.json and convert to SARIF for upload as a code scanning alert

name: Veracode Static Analysis Pipeline Scan

  - name: Convert pipeline scan output to SARIF format
    id: convert
    uses: Veracode/veracode-pipeline-scan-results-to-sarif@v0.1.2
    with:
      pipeline-results-json: results.json
      output-results-sarif: veracode-results.sarif
      source-base-path-1: "^com/veracode:src/main/java/com/veracode"
      source-base-path-2: "^WEB-INF:src/main/webapp/WEB-INF"
      finding-rule-level: "3:1:0"

  - name: upload sarif file to repository
    uses: github/codeql-action/upload-sarif@v1
    with: # Path to SARIF file relative to the root of the repository
      sarif_file: veracode-results.sarif
